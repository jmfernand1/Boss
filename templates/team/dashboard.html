{% extends 'base.html' %}

{% block title %}Dashboard - Equipo{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row mb-5 fade-in">
        <div class="col-12 d-flex justify-content-between align-items-center">
            <div>
                <h1 class="display-5 fw-bold text-primary mb-1">
                    <i class="fas fa-users me-2"></i>Dashboard del Equipo
                </h1>
                <p class="text-muted lead mb-0">Gesti√≥n de personal y seguimiento de ausencias</p>
            </div>
            <a href="{% url 'team:employee_list' %}" class="btn btn-primary shadow-sm">
                <i class="fas fa-plus me-2"></i>Nuevo Empleado
            </a>
        </div>
    </div>

    <!-- Estad√≠sticas -->
    <div class="row mb-5 g-4 fade-in" style="animation-delay: 0.1s;">
        <div class="col-md-3">
            <div class="card stat-card h-100 border-0 shadow-hover">
                <div class="card-body text-center p-4">
                    <div class="avatar bg-primary bg-opacity-10 text-primary rounded-circle p-3 mb-3 mx-auto"
                        style="width: 64px; height: 64px;">
                        <i class="fas fa-users fa-2x"></i>
                    </div>
                    <h2 class="fw-bold mb-1">{{ total_employees }}</h2>
                    <p class="text-muted mb-0">Empleados Activos</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card h-100 border-0 shadow-hover">
                <div class="card-body text-center p-4">
                    <div class="avatar bg-warning bg-opacity-10 text-warning rounded-circle p-3 mb-3 mx-auto"
                        style="width: 64px; height: 64px;">
                        <i class="fas fa-user-clock fa-2x"></i>
                    </div>
                    <h2 class="fw-bold mb-1">{{ current_absences|length }}</h2>
                    <p class="text-muted mb-0">Ausencias Hoy</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card h-100 border-0 shadow-hover">
                <div class="card-body text-center p-4">
                    <div class="avatar bg-info bg-opacity-10 text-info rounded-circle p-3 mb-3 mx-auto"
                        style="width: 64px; height: 64px;">
                        <i class="fas fa-birthday-cake fa-2x"></i>
                    </div>
                    <h2 class="fw-bold mb-1">{{ upcoming_birthdays|length }}</h2>
                    <p class="text-muted mb-0">Cumplea√±os (30 d√≠as)</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card h-100 border-0 shadow-hover">
                <div class="card-body text-center p-4">
                    <div class="avatar bg-success bg-opacity-10 text-success rounded-circle p-3 mb-3 mx-auto"
                        style="width: 64px; height: 64px;">
                        <i class="fas fa-plane-departure fa-2x"></i>
                    </div>
                    <h2 class="fw-bold mb-1">{{ upcoming_absences|length }}</h2>
                    <p class="text-muted mb-0">Pr√≥ximas Ausencias</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-4 fade-in" style="animation-delay: 0.2s;">
        <!-- Ausencias Actuales -->
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 fw-bold">üìÖ Ausencias de Hoy</h5>
                    <span class="badge bg-warning text-dark rounded-pill">{{ current_absences|length }}</span>
                </div>
                <div class="card-body p-0">
                    {% if current_absences %}
                    <div class="list-group list-group-flush">
                        {% for absence in current_absences %}
                        <div class="list-group-item p-3 border-bottom-0 border-top">
                            <div class="d-flex align-items-center">
                                <div class="avatar bg-warning bg-opacity-10 text-warning rounded-circle p-2 me-3">
                                    <i class="fas fa-user-slash"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0 fw-bold">{{ absence.employee.full_name }}</h6>
                                    <small class="text-muted">{{ absence.absence_type.name }}</small>
                                </div>
                                <div class="text-end">
                                    <span class="badge bg-light text-dark border">
                                        {{ absence.start_date|date:"d/m" }} - {{ absence.end_date|date:"d/m" }}
                                    </span>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="p-5 text-center text-muted">
                        <i class="fas fa-check-circle fa-3x mb-3 text-success opacity-50"></i>
                        <p class="mb-0 fw-medium">¬°Todo el equipo est√° presente hoy!</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Pr√≥ximos Cumplea√±os -->
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 fw-bold">üéÇ Pr√≥ximos Cumplea√±os</h5>
                    <span class="badge bg-info text-dark rounded-pill">{{ upcoming_birthdays|length }}</span>
                </div>
                <div class="card-body p-0">
                    {% if upcoming_birthdays %}
                    <div class="list-group list-group-flush">
                        {% for birthday in upcoming_birthdays %}
                        <div class="list-group-item p-3 border-bottom-0 border-top">
                            <div class="d-flex align-items-center">
                                <div class="avatar bg-info bg-opacity-10 text-info rounded-circle p-2 me-3">
                                    <i class="fas fa-birthday-cake"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0 fw-bold">{{ birthday.employee.full_name }}</h6>
                                    <small class="text-muted">{{ birthday.employee.position }}</small>
                                </div>
                                <div class="text-end">
                                    <div class="fw-bold text-primary">{{ birthday.birthday|date:"d M" }}</div>
                                    <small class="text-muted">Cumple {{ birthday.age }}</small>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="p-5 text-center text-muted">
                        <i class="fas fa-calendar fa-3x mb-3 opacity-25"></i>
                        <p class="mb-0">No hay cumplea√±os en los pr√≥ximos 30 d√≠as</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Accesos R√°pidos -->
    <div class="row mt-5 fade-in" style="animation-delay: 0.3s;">
        <div class="col-12">
            <h4 class="fw-bold mb-4">‚ö° Accesos R√°pidos</h4>
            <div class="row g-3">
                <div class="col-md-3">
                    <a href="{% url 'team:employee_list' %}"
                        class="card h-100 border-0 shadow-sm hover-lift text-decoration-none">
                        <div class="card-body d-flex align-items-center p-3">
                            <div class="avatar bg-primary bg-opacity-10 text-primary rounded p-3 me-3">
                                <i class="fas fa-users fa-lg"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Ver Empleados</h6>
                                <small class="text-muted">Directorio completo</small>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="{% url 'team:absence_list' %}"
                        class="card h-100 border-0 shadow-sm hover-lift text-decoration-none">
                        <div class="card-body d-flex align-items-center p-3">
                            <div class="avatar bg-warning bg-opacity-10 text-warning rounded p-3 me-3">
                                <i class="fas fa-calendar-times fa-lg"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Gestionar Ausencias</h6>
                                <small class="text-muted">Registro y control</small>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="{% url 'team:vacation_summary' %}"
                        class="card h-100 border-0 shadow-sm hover-lift text-decoration-none">
                        <div class="card-body d-flex align-items-center p-3">
                            <div class="avatar bg-success bg-opacity-10 text-success rounded p-3 me-3">
                                <i class="fas fa-umbrella-beach fa-lg"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Control de Vacaciones</h6>
                                <small class="text-muted">Saldos y solicitudes</small>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="{% url 'team:birthday_calendar' %}"
                        class="card h-100 border-0 shadow-sm hover-lift text-decoration-none">
                        <div class="card-body d-flex align-items-center p-3">
                            <div class="avatar bg-info bg-opacity-10 text-info rounded p-3 me-3">
                                <i class="fas fa-birthday-cake fa-lg"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold text-dark">Calendario</h6>
                                <small class="text-muted">Eventos y fechas</small>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}